) +
ggplot2::geom_point(colour = SURF_PURPLE, size = 2.8) +
ggplot2::geom_errorbar(
ggplot2::aes(ymin = ymin, ymax = ymax),
width = 0.2,
colour = SURF_PURPLE
) +
ggplot2::facet_wrap(~ owner_group) +
ggplot2::labs(
title = "Teilnahmebereitschaft vor dem Szenario nach Experimentalbedingung",
subtitle = "Mittelwerte mit 95%-Konfidenzintervallen",
x = "Experimentalbedingung (Häufigkeit der Steuerung)",
y = "Teilnahmeintention (Mittelwert)"
) +
theme_surf(base_size = 11)
p_part_pre_exp_branded <- brand_plot_surf(p_part_pre_exp)
save_plot(
plot = p_part_pre_exp_branded,
block = 3,
sub = 2,
slug = "participation_pre_experiment_owner"
)
p_part_pre_exp_branded
#| label: plot-03-03-part-post-groups
#| warning: false
#| message: false
part_post_groups <- daten_analysis |>
dplyr::bind_rows(
daten_analysis |> dplyr::mutate(owner_group = "Gesamtstichprobe")
) |>
dplyr::group_by(owner_group) |>
dplyr::summarise(mean_ci(part_post_real), .groups = "drop")
p_part_post_groups <- ggplot2::ggplot(
part_post_groups,
ggplot2::aes(x = owner_group, y = mean)
) +
ggplot2::geom_point(colour = SURF_PURPLE, size = 3) +
ggplot2::geom_errorbar(
ggplot2::aes(ymin = ymin, ymax = ymax),
width = 0.15,
colour = SURF_PURPLE
) +
ggplot2::labs(
title = "Teilnahmebereitschaft nach dem Szenario",
subtitle = "Gesamtstichprobe und nach Gerätebesitz",
x = NULL,
y = "Teilnahmeintention (Mittelwert)"
) +
theme_surf(base_size = 12)
p_part_post_groups_branded <- brand_plot_surf(p_part_post_groups)
save_plot(
plot = p_part_post_groups_branded,
block = 3,
sub = 3,
slug = "participation_post_owner"
)
p_part_post_groups_branded
#| label: plot-03-04-part-post-experiment
#| warning: false
#| message: false
part_post_exp <- daten_analysis |>
dplyr::group_by(owner_group, rand_freq) |>
dplyr::summarise(mean_ci(part_post_real), .groups = "drop")
p_part_post_exp <- ggplot2::ggplot(
part_post_exp,
ggplot2::aes(x = rand_freq, y = mean)
) +
ggplot2::geom_point(colour = SURF_PURPLE, size = 2.8) +
ggplot2::geom_errorbar(
ggplot2::aes(ymin = ymin, ymax = ymax),
width = 0.2,
colour = SURF_PURPLE
) +
ggplot2::facet_wrap(~ owner_group) +
ggplot2::labs(
title = "Teilnahmebereitschaft nach dem Szenario nach Experimentalbedingung",
subtitle = "Mittelwerte mit 95%-Konfidenzintervallen",
x = "Experimentalbedingung (Häufigkeit der Steuerung)",
y = "Teilnahmeintention (Mittelwert)"
) +
theme_surf(base_size = 11)
p_part_post_exp_branded <- brand_plot_surf(p_part_post_exp)
save_plot(
plot = p_part_post_exp_branded,
block = 3,
sub = 4,
slug = "participation_post_experiment_owner"
)
p_part_post_exp_branded
#| label: plot-03-05-part-diff-groups
#| warning: false
#| message: false
part_diff_groups <- daten_analysis |>
dplyr::bind_rows(
daten_analysis |> dplyr::mutate(owner_group = "Gesamtstichprobe")
) |>
dplyr::group_by(owner_group) |>
dplyr::summarise(mean_ci(part_diff), .groups = "drop")
p_part_diff_groups <- ggplot2::ggplot(
part_diff_groups,
ggplot2::aes(x = owner_group, y = mean)
) +
ggplot2::geom_hline(yintercept = 0, colour = SURF_GRID, linewidth = 0.4) +
ggplot2::geom_point(colour = SURF_PURPLE, size = 3) +
ggplot2::geom_errorbar(
ggplot2::aes(ymin = ymin, ymax = ymax),
width = 0.15,
colour = SURF_PURPLE
) +
ggplot2::labs(
title = "Veränderung der Teilnahmebereitschaft durch das Szenario",
subtitle = "Differenz aus Teilnahmeintention nach und vor dem Szenario",
x = NULL,
y = "Änderung der Teilnahmeintention"
) +
theme_surf(base_size = 12)
p_part_diff_groups_branded <- brand_plot_surf(p_part_diff_groups)
save_plot(
plot = p_part_diff_groups_branded,
block = 3,
sub = 5,
slug = "participation_difference_owner"
)
p_part_diff_groups_branded
#| label: plot-03-06-part-diff-experiment
#| warning: false
#| message: false
part_diff_exp <- daten_analysis |>
dplyr::group_by(owner_group, rand_freq) |>
dplyr::summarise(mean_ci(part_diff), .groups = "drop")
p_part_diff_exp <- ggplot2::ggplot(
part_diff_exp,
ggplot2::aes(x = rand_freq, y = mean)
) +
ggplot2::geom_hline(yintercept = 0, colour = SURF_GRID, linewidth = 0.4) +
ggplot2::geom_point(colour = SURF_PURPLE, size = 2.8) +
ggplot2::geom_errorbar(
ggplot2::aes(ymin = ymin, ymax = ymax),
width = 0.2,
colour = SURF_PURPLE
) +
ggplot2::facet_wrap(~ owner_group) +
ggplot2::labs(
title = "Veränderung der Teilnahmebereitschaft nach Experimentalbedingung",
subtitle = "POST − PRE, Mittelwerte mit 95%-Konfidenzintervallen",
x = "Experimentalbedingung (Häufigkeit der Steuerung)",
y = "Änderung der Teilnahmeintention"
) +
theme_surf(base_size = 11)
p_part_diff_exp_branded <- brand_plot_surf(p_part_diff_exp)
save_plot(
plot = p_part_diff_exp_branded,
block = 3,
sub = 6,
slug = "participation_difference_experiment_owner"
)
p_part_diff_exp_branded
#| label: b04-prepare-control
#| warning: false
#| message: false
# Steuerungsvariablen
control_vars <- names(daten_analysis)[stringr::str_detect(names(daten_analysis), "^control_")]
# Lesbare Gerätelabels (bitte ggf. exakt an euren Fragebogen anpassen)
control_labels <- c(
control_wallbox = "Wallbox",
control_heatpump = "Wärmepumpe",
control_battery = "Batteriespeicher",
control_pv = "Photovoltaikanlage",
control_ems = "Energiemanagementsystem"
)
# Long-Format
control_long <- daten_analysis |>
dplyr::select(all_of(control_vars), owner_group, rand_freq) |>
tidyr::pivot_longer(
cols = all_of(control_vars),
names_to = "device",
values_to = "control_raw"
) |>
dplyr::mutate(
device_label = dplyr::recode(device, !!!control_labels),
control_yes = suppressWarnings(as.integer(as.character(control_raw))) == 1
)
#| label: b04-prepare-control
#| warning: false
#| message: false
# Steuerungsvariablen
control_vars <- names(daten_analysis)[stringr::str_detect(names(daten_analysis), "^control_")]
# Lesbare Gerätelabels (bitte ggf. exakt an euren Fragebogen anpassen)
control_labels <- c(
control_wallbox = "Wallbox",
control_heatpump = "Wärmepumpe",
control_battery = "Batteriespeicher",
control_pv = "Photovoltaikanlage",
control_ems = "Energiemanagementsystem"
)
# Long-Format
control_long <- daten_analysis |>
dplyr::select(all_of(control_vars), owner_group, rand_freq) |>
tidyr::pivot_longer(
cols = all_of(control_vars),
names_to = "device",
values_to = "control_raw"
) |>
dplyr::mutate(
device_label = dplyr::recode(device, !!!control_labels),
control_yes = suppressWarnings(as.integer(as.character(control_raw))) == 1
)
#| label: b04-control-among-owners
#| warning: false
#| message: false
# ------------------------------------------------------------
# Steuerungsbereitschaft je Gerät – nur unter Gerätebesitzern
# Definition: Anteil "Ja" in control_* innerhalb owner_group == "Gerätebesitzer"
# Output:
#  - Tabelle (Prozent)
#  - Plot (Prozent), Export: outputs/plots/04_03_control_among_owners.png
# ------------------------------------------------------------
# Falls control_long noch nicht existiert (robust)
if (!exists("control_long")) {
control_vars <- names(daten_analysis)[stringr::str_detect(names(daten_analysis), "^control_")]
control_labels <- c(
control_wallbox = "Wallbox",
control_heatpump = "Wärmepumpe",
control_battery = "Batteriespeicher",
control_pv = "Photovoltaikanlage",
control_ems = "Energiemanagementsystem"
)
control_long <- daten_analysis |>
dplyr::select(dplyr::all_of(control_vars), owner_group, rand_freq) |>
tidyr::pivot_longer(
cols = dplyr::all_of(control_vars),
names_to = "device",
values_to = "control_raw"
) |>
dplyr::mutate(
device_label = dplyr::recode(device, !!!control_labels),
control_yes = suppressWarnings(as.integer(as.character(control_raw))) == 1
)
}
# 1) Nur Gerätebesitzer
control_owners <- control_long |>
dplyr::filter(owner_group == "Gerätebesitzer")
# 2) Zustimmung je Gerät (Prozent)
control_owners_summary <- control_owners |>
dplyr::group_by(device_label) |>
dplyr::summarise(
Zustimmung = mean(control_yes, na.rm = TRUE),
n = sum(!is.na(control_yes)),
.groups = "drop"
) |>
dplyr::mutate(
Zustimmung_pct = round(Zustimmung * 100, 1)
) |>
dplyr::arrange(dplyr::desc(Zustimmung))
# Tabelle
knitr::kable(
control_owners_summary |>
dplyr::select(device_label, n, Zustimmung_pct),
col.names = c("Gerät", "n (gültig)", "Zustimmung (%)"),
align = c("l", "r", "r"),
caption = "Grundsätzliche Bereitschaft zur automatischen Steuerung (nur unter Gerätebesitzern)."
)
# 3) Plot (Prozent)
p_control_owners <- ggplot2::ggplot(
control_owners_summary,
ggplot2::aes(x = Zustimmung, y = reorder(device_label, Zustimmung))
) +
ggplot2::geom_col(fill = SURF_PURPLE, width = 0.7) +
ggplot2::scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
ggplot2::labs(
title = "Steuerungsbereitschaft unter Gerätebesitzern",
subtitle = "Anteil zustimmender Haushalte (nur Haushalte mit vorhandenem Gerät)",
x = "Zustimmung zur Steuerung",
y = NULL
) +
theme_surf(base_size = 12)
p_control_owners_branded <- brand_plot_surf(p_control_owners)
# Export
save_plot(
plot  = p_control_owners_branded,
block = 4,
sub   = 3,
slug  = "control_among_owners"
)
p_control_owners_branded
#| label: plot-04-01-control-overview
#| warning: false
#| message: false
control_overview <- control_long |>
dplyr::group_by(device_label, owner_group) |>
dplyr::summarise(
Anteil = mean(control_yes, na.rm = TRUE),
.groups = "drop"
)
p_control_overview <- ggplot2::ggplot(
control_overview,
ggplot2::aes(
y = device_label,
x = Anteil,
fill = owner_group
)
) +
ggplot2::geom_col(
position = "dodge",
width = 0.7,
colour = "white",
linewidth = 0.2
) +
ggplot2::scale_x_continuous(
labels = scales::percent_format(accuracy = 1)
) +
ggplot2::scale_fill_manual(
values = c(
"Gerätebesitzer" = SURF_PURPLE,
"Nicht-Besitzer" = SURF_PINK
)
) +
ggplot2::labs(
title = "Grundsätzliche Bereitschaft zur automatischen Gerätesteuerung",
subtitle = "Anteil zustimmender Haushalte nach Gerätetyp und Gerätebesitz",
x = "Anteil der Befragten",
y = NULL,
fill = NULL
) +
theme_surf(base_size = 12) +
surf_legend_bottom(nrow = 1, text_size = 9)
p_control_overview_branded <- brand_plot_surf(p_control_overview)
save_plot(
plot = p_control_overview_branded,
block = 4,
sub = 1,
slug = "control_overview_owner"
)
p_control_overview_branded
#| label: plot-04-02-control-experiment
#| warning: false
#| message: false
control_exp <- control_long |>
dplyr::group_by(device_label, owner_group, rand_freq) |>
dplyr::summarise(
Anteil = mean(control_yes, na.rm = TRUE),
.groups = "drop"
)
p_control_exp <- ggplot2::ggplot(
control_exp,
ggplot2::aes(
x = rand_freq,
y = Anteil,
colour = owner_group,
group = owner_group
)
) +
ggplot2::geom_point(size = 2.5) +
ggplot2::geom_line(linewidth = 0.6) +
ggplot2::facet_wrap(~ device_label) +
ggplot2::scale_y_continuous(
labels = scales::percent_format(accuracy = 1)
) +
ggplot2::scale_colour_manual(
values = c(
"Gerätebesitzer" = SURF_PURPLE,
"Nicht-Besitzer" = SURF_PINK
)
) +
ggplot2::labs(
title = "Steuerungsbereitschaft nach Experimentalbedingung",
subtitle = "Anteil zustimmender Haushalte nach Gerät, Besitzstatus und Steuerungshäufigkeit",
x = "Experimentalbedingung (Häufigkeit der Steuerung)",
y = "Anteil Zustimmung",
colour = NULL
) +
theme_surf(base_size = 11) +
surf_legend_bottom(nrow = 1, text_size = 9)
p_control_exp_branded <- brand_plot_surf(p_control_exp)
save_plot(
plot = p_control_exp_branded,
block = 4,
sub = 2,
slug = "control_experiment_owner"
)
p_control_exp_branded
#| label: table-04-control-summary
#| warning: false
#| message: false
control_table <- control_overview |>
dplyr::mutate(
Anteil = round(Anteil * 100, 1)
)
knitr::kable(
control_table,
col.names = c("Gerät", "Besitzstatus", "Zustimmung (%)"),
align = c("l", "l", "r"),
caption = "Grundsätzliche Bereitschaft zur automatischen Gerätesteuerung nach Gerätetyp und Besitzstatus."
)
#| label: b04-control-among-nonowners
#| warning: false
#| message: false
# ------------------------------------------------------------
# Steuerungsbereitschaft je Gerät – nur unter Nicht-Besitzern
# Output:
#  - Tabelle (Prozent)
#  - Plot (Prozent), Export: outputs/plots/04_04_control_among_nonowners.png
# ------------------------------------------------------------
# control_long falls nötig erzeugen (robust)
if (!exists("control_long")) {
control_vars <- names(daten_analysis)[stringr::str_detect(names(daten_analysis), "^control_")]
control_labels <- c(
control_wallbox  = "Wallbox",
control_heatpump = "Wärmepumpe",
control_battery  = "Batteriespeicher",
control_pv       = "Photovoltaikanlage",
control_ems      = "Energiemanagementsystem"
)
control_long <- daten_analysis |>
dplyr::select(dplyr::all_of(control_vars), owner_group, rand_freq) |>
tidyr::pivot_longer(
cols = dplyr::all_of(control_vars),
names_to = "device",
values_to = "control_raw"
) |>
dplyr::mutate(
device_label = dplyr::recode(device, !!!control_labels),
control_yes  = suppressWarnings(as.integer(as.character(control_raw))) == 1
)
}
control_nonowners <- control_long |>
dplyr::filter(owner_group == "Nicht-Besitzer")
control_nonowners_summary <- control_nonowners |>
dplyr::group_by(device_label) |>
dplyr::summarise(
Zustimmung = mean(control_yes, na.rm = TRUE),
n = sum(!is.na(control_yes)),
.groups = "drop"
) |>
dplyr::mutate(
Zustimmung_pct = round(Zustimmung * 100, 1)
) |>
dplyr::arrange(dplyr::desc(Zustimmung))
# Tabelle
knitr::kable(
control_nonowners_summary |>
dplyr::select(device_label, n, Zustimmung_pct),
col.names = c("Gerät", "n (gültig)", "Zustimmung (%)"),
align = c("l", "r", "r"),
caption = "Grundsätzliche Bereitschaft zur automatischen Steuerung (nur unter Nicht-Besitzern)."
)
# Plot
p_control_nonowners <- ggplot2::ggplot(
control_nonowners_summary,
ggplot2::aes(x = Zustimmung, y = reorder(device_label, Zustimmung))
) +
ggplot2::geom_col(fill = SURF_PINK, width = 0.7) +
ggplot2::scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
ggplot2::labs(
title = "Steuerungsbereitschaft unter Nicht-Besitzern",
subtitle = "Anteil zustimmender Haushalte (Haushalte ohne vorhandenes Gerät)",
x = "Zustimmung zur Steuerung",
y = NULL
) +
theme_surf(base_size = 12)
p_control_nonowners_branded <- brand_plot_surf(p_control_nonowners)
save_plot(
plot  = p_control_nonowners_branded,
block = 4,
sub   = 4,
slug  = "control_among_nonowners"
)
p_control_nonowners_branded
#| label: b04-control-owner-nonowner-diff
#| warning: false
#| message: false
# ------------------------------------------------------------
# Differenz je Gerät: Zustimmung (Besitzer) - Zustimmung (Nicht-Besitzer)
# Output:
#  - Plot, Export: outputs/plots/04_05_control_owner_minus_nonowner.png
# ------------------------------------------------------------
control_diff <- control_long |>
dplyr::group_by(device_label, owner_group) |>
dplyr::summarise(
Zustimmung = mean(control_yes, na.rm = TRUE),
.groups = "drop"
) |>
tidyr::pivot_wider(
names_from = owner_group,
values_from = Zustimmung
) |>
dplyr::mutate(
diff = `Gerätebesitzer` - `Nicht-Besitzer`
) |>
dplyr::arrange(diff)
p_control_diff <- ggplot2::ggplot(
control_diff,
ggplot2::aes(x = diff, y = reorder(device_label, diff))
) +
ggplot2::geom_vline(xintercept = 0, colour = SURF_GRID, linewidth = 0.4) +
ggplot2::geom_col(fill = SURF_MAG, width = 0.7) +
ggplot2::scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
ggplot2::labs(
title = "Besitz-Effekt auf die Steuerungsbereitschaft",
subtitle = "Differenz der Zustimmungsanteile: Gerätebesitzer minus Nicht-Besitzer",
x = "Differenz in Prozentpunkten",
y = NULL
) +
theme_surf(base_size = 12)
p_control_diff_branded <- brand_plot_surf(p_control_diff)
save_plot(
plot  = p_control_diff_branded,
block = 4,
sub   = 5,
slug  = "control_owner_minus_nonowner"
)
p_control_diff_branded
