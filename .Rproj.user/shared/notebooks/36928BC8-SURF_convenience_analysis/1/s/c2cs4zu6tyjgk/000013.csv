"0","#| label: b04-control-owner-nonowner-diff"
"0","#| warning: false"
"0","#| message: false"
"0",""
"0","# ------------------------------------------------------------"
"0","# Differenz je Gerät: Zustimmung (Besitzer) - Zustimmung (Nicht-Besitzer)"
"0","# Output:"
"0","#  - Plot, Export: outputs/plots/04_05_control_owner_minus_nonowner.png"
"0","# ------------------------------------------------------------"
"0",""
"0","control_diff <- control_long |>"
"0","  dplyr::group_by(device_label, owner_group) |>"
"0","  dplyr::summarise("
"0","    Zustimmung = mean(control_yes, na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  ) |>"
"0","  tidyr::pivot_wider("
"0","    names_from = owner_group,"
"0","    values_from = Zustimmung"
"0","  ) |>"
"0","  dplyr::mutate("
"0","    diff = `Gerätebesitzer` - `Nicht-Besitzer`"
"0","  ) |>"
"0","  dplyr::arrange(diff)"
"0",""
"0","p_control_diff <- ggplot2::ggplot("
"0","  control_diff,"
"0","  ggplot2::aes(x = diff, y = reorder(device_label, diff))"
"0",") +"
"0","  ggplot2::geom_vline(xintercept = 0, colour = SURF_GRID, linewidth = 0.4) +"
"0","  ggplot2::geom_col(fill = SURF_MAG, width = 0.7) +"
"0","  ggplot2::scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +"
"0","  ggplot2::labs("
"0","    title = ""Besitz-Effekt auf die Steuerungsbereitschaft"","
"0","    subtitle = ""Differenz der Zustimmungsanteile: Gerätebesitzer minus Nicht-Besitzer"","
"0","    x = ""Differenz in Prozentpunkten"","
"0","    y = NULL"
"0","  ) +"
"0","  theme_surf(base_size = 12)"
"0",""
"0","p_control_diff_branded <- brand_plot_surf(p_control_diff)"
"0",""
"0","save_plot("
"0","  plot  = p_control_diff_branded,"
"0","  block = 4,"
"0","  sub   = 5,"
"0","  slug  = ""control_owner_minus_nonowner"""
"0",")"
"0",""
"0","p_control_diff_branded"
"0",""
