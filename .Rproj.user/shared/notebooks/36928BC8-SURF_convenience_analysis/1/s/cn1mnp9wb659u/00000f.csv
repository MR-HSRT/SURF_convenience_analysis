"0","#| label: custom-functions"
"0","#| include: false"
"0",""
"0","# Save-Plot Engine"
"0","save_plot <- function(plot, block, sub, slug,"
"0","                      width = 8, height = 5, dpi = 300) {"
"0","  filename <- sprintf(""%02d_%02d_%s.png"", block, sub, slug)"
"0","  path <- file.path(PLOTS_DIR, filename)"
"0","  ggplot2::ggsave(filename = path, plot = plot, width = width, height = height, dpi = dpi)"
"0","  invisible(path)"
"0","}"
"0",""
"0","# Mean and CI"
"0","mean_ci <- function(x) {"
"0","  x <- x[!is.na(x)]"
"0","  n <- length(x)"
"0","  m <- mean(x)"
"0","  se <- sd(x) / sqrt(n)"
"0","  ci <- qt(0.975, df = n - 1) * se"
"0","  tibble::tibble("
"0","    mean = m,"
"0","    ymin = m - ci,"
"0","    ymax = m + ci"
"0","  )"
"0","}"
"0",""
