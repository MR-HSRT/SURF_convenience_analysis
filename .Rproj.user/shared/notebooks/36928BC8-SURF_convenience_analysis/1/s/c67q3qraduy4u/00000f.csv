"0","#| label: b04-prepare-control"
"0","#| warning: false"
"0","#| message: false"
"0",""
"0","# Steuerungsvariablen"
"0","control_vars <- names(daten_analysis)[stringr::str_detect(names(daten_analysis), ""^control_"")]"
"0",""
"0","# Lesbare Gerätelabels (bitte ggf. exakt an euren Fragebogen anpassen)"
"0","control_labels <- c("
"0","  control_wallbox = ""Wallbox"","
"0","  control_heatpump = ""Wärmepumpe"","
"0","  control_battery = ""Batteriespeicher"","
"0","  control_pv = ""Photovoltaikanlage"","
"0","  control_ems = ""Energiemanagementsystem"""
"0",")"
"0",""
"0","# Long-Format"
"0","control_long <- daten_analysis |>"
"0","  dplyr::select(all_of(control_vars), owner_group, rand_freq) |>"
"0","  tidyr::pivot_longer("
"0","    cols = all_of(control_vars),"
"0","    names_to = ""device"","
"0","    values_to = ""control_raw"""
"0","  ) |>"
"0","  dplyr::mutate("
"0","    device_label = dplyr::recode(device, !!!control_labels),"
"0","    control_yes = suppressWarnings(as.integer(as.character(control_raw))) == 1"
"0","  )"
"0",""
